
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4. Dockerizing DraCor, for Example. On Versioning Programmable Corpora &#8212; D7.3 On Versioning Living and Programmable Corpora</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '4_dockerizing_dracor';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="5. Key Takeaways" href="5_key_takeaways.html" />
    <link rel="prev" title="Excursus: An Algorithmic Archaeology of a Living Corpus: GerDraCor as a Dynamic Epistemic Object" href="3-2_gerdracor_corpus_archeology.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="0_index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="D7.3 On Versioning Living and Programmable Corpora - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="D7.3 On Versioning Living and Programmable Corpora - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="0_index.html">
                    D7.3 On Versioning Living and Programmable Corpora
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1_summary.html">1. Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_introduction.html">2. Introduction: The Problem of Reproducibility in Dynamic Digital Ecosystems</a></li>
<li class="toctree-l1"><a class="reference internal" href="3-1_versioning_living_corpora.html">3. Versioning Living Corpora Using Git Commit</a></li>
<li class="toctree-l1"><a class="reference internal" href="3-2_gerdracor_corpus_archeology.html">Excursus: An Algorithmic Archaeology of a Living Corpus: GerDraCor as a Dynamic Epistemic Object</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">4. Dockerizing DraCor, for Example. On Versioning Programmable Corpora</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_key_takeaways.html">5. Key Takeaways</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/dh-network/clsinfra-d73" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/dh-network/clsinfra-d73/issues/new?title=Issue%20on%20page%20%2F4_dockerizing_dracor.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/4_dockerizing_dracor.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>4. Dockerizing DraCor, for Example. On Versioning Programmable Corpora</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#containerizing-a-research-environment">4.1 Containerizing a Research Environment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-study-dockerizing-a-complete-cls-study">4.2 Case Study: Dockerizing a Complete CLS Study</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simplifying-the-workflow-stabledracor">4.3 Simplifying the Workflow: StableDraCor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#practical-examples">4.4 Practical Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reconstructing-and-stabilizing-corpora-used-to-train-and-evaluate-a-classifier-for-chiasmus-detection">4.4.1 Reconstructing (and Stabilizing) Corpora Used to Train and Evaluate a Classifier for Chiasmus Detection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gerdracor-based-dlina-sydney-corpus">4.4.2 GerDraCor-based DLINA Sydney Corpus</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is still a draft! Please refer to the PDF version.</p>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="dockerizing-dracor-for-example-on-versioning-programmable-corpora">
<h1>4. Dockerizing DraCor, for Example. On Versioning Programmable Corpora<a class="headerlink" href="#dockerizing-dracor-for-example-on-versioning-programmable-corpora" title="Link to this heading">#</a></h1>
<blockquote class="epigraph">
<div><p>I make no claims to elegance in programming,
but I am confident that the scripts work,
at least as of today.</p>
<p class="attribution">—Andrew Piper, Foreword to <em>Enumerations</em></p>
</div></blockquote>
<section id="containerizing-a-research-environment">
<span id="section-4-1"></span><h2>4.1 Containerizing a Research Environment<a class="headerlink" href="#containerizing-a-research-environment" title="Link to this heading">#</a></h2>
<p>As already noted in the introduction (see <a class="reference internal" href="2_introduction.html#section-2"><span class="std std-ref">2. Introduction: The Problem of Reproducibility in Dynamic Digital Ecosystems</span></a>), the use of a version control system like Git  can be seen as both a powerful and user-friendly mechanism to stabilize “living” corpora. However, “programmable” corpora consist of a connection of data (“living corpus”) with a lightweight research software (in the form of a research-driven API) whereby this connection can be conceptualized as a distributed research infrastructure in a dynamic digital ecosystem (cf. <span id="id1">Börner and Trilcke [<a class="reference internal" href="bibliography.html#id2" title="Ingo Börner and Peer Trilcke. Cls infra d7.1 on programmable corpora. April 2023. URL: https://doi.org/10.5281/zenodo.7664964, doi:10.5281/zenodo.7664964.">2023</a>]</span>). Such a research infrastructure can no longer be stabilized only via the versioning mechanism of Git, since in addition to the two components (data, code), their specific connection is also crucial for the possibility of reproducing the research conducted with it. For such scenarios, as will be shown below, a container-based approach is suitable, whereby we will rely on containerization using the <a class="reference external" href="https://www.docker.com">Docker</a> software.</p>
<p>Our approach is inspired by the concept of research artifacts from computer science, which is described by Arvan et al. as “self-contained packages that contain everything needed to reproduce results reported in a paper” and which are also “typically self-executable, meaning that they are packaged within a virtual machine […] or within a container” <span id="id2">[<a class="reference internal" href="bibliography.html#id21" title="Mohammad Arvan, Luís Pina, and Natalie Parde. Reproducibility in Computational Linguistics: Is Source Code Enough? In Yoav Goldberg, Zornitsa Kozareva, and Yue Zhang, editors, Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing, 2350–2361. Abu Dhabi, United Arab Emirates, December 2022. Association for Computational Linguistics. URL: https://aclanthology.org/2022.emnlp-main.150, doi:10.18653/v1/2022.emnlp-main.150.">Arvan <em>et al.</em>, 2022</a>]</span>. The prototypical implementation, on which we will report in the following, is again based on the Drama Corpora Platform, DraCor. In a DraCor-based experiment, we set ourselves the challenge of making a network-analytic study, which we conducted for a paper publication, as fully replicable as possible using Docker.</p>
<p>The containerization technology “Docker” is widely used in the IT industry, because it can speed up development cycles and can reduce overhead when deploying applications. Especially in the field of “DevOps” – “Dev” for development and “Ops” for operations, which refers to the processes that are necessary to have an application run on a server – the importance of communication between the development and the operations team is considered highly important. Thus Docker workflows have been introduced. They do not only streamline communication processes, they also shift the responsibility of handling software dependencies to the development team: Docker enables the people actually writing the application to specify the environment in which their software should be run. There are a couple of key components to such workflows: The so-called “Dockerfile”<a class="footnote-reference brackets" href="#dockerfile" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> is a meaningful and executable form of documentation. It contains the steps necessary to build a highly portable, self-contained digital artifact, a “Docker image”<a class="footnote-reference brackets" href="#dockerimage" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>. These images can be easily deployed on a designated infrastructure as “Docker containers”<a class="footnote-reference brackets" href="#dockercontainer" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>.</p>
<p>Certainly, in CLS research projects we will rarely find teams of development and operation professionals that are in need of communicating better. But, we would like to argue that still the attempt of reproducing research could be framed in a similar sense: On the one hand we have an individual researcher (or a team of researchers) that conducts a study. In our analogy, these are the developers. Their product – a study – relies on some application or script that operates on data. On the other hand we have researchers wanting to reproduce or verify the results, similar to operations professionals that have to deploy someone else’s application on a server.</p>
<p>It becomes evident that some hurdles in the process of reproducing CLS research exist due to a lack of clear communication on how to run the analysis scripts and a tendency to offload the responsibility of setting up an environment in which the analysis could be executed to the reproducing party. A containerized research environment might circumvent these problems: Instead of claiming that scripts “work, at least as of today” on the machine of the developing researcher, as for example, Andrew Piper writes it in his foreword to his book “Enumerations” <span id="id6">[<a class="reference internal" href="bibliography.html#id22" title="Andrew Piper. Enumerations: data and literary study. The University of Chicago Press, Chicago, 2018. ISBN 978-0-226-56875-1 978-0-226-56861-4 978-0-226-56889-8.">Piper, 2018</a>, xii]</span>; when employing container technology, it could be guaranteed instead that a container created from an image containing a runnable self-contained research environment can be re-run. This would allow for a reproduction of the study. Instead of saying: The analysis was run-able on my machine when writing the paper and publishing the code only, in addition a researcher could provide a run-able research artifact alongside the study. When using Docker, this could be one or more images that would allow to re-create the research environment the study was conducted in.<a class="footnote-reference brackets" href="#open-container-initiative" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a></p>
<p>In the following, we will report on our exemplary experiment in making a CLS study replicable by using Docker technology.<a class="footnote-reference brackets" href="#graz-presentation" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a></p>
</section>
<section id="case-study-dockerizing-a-complete-cls-study">
<span id="section-4-2"></span><h2>4.2 Case Study: Dockerizing a Complete CLS Study<a class="headerlink" href="#case-study-dockerizing-a-complete-cls-study" title="Link to this heading">#</a></h2>
<p>We exemplify the benefits of a Docker-based research workflow by referring to our study “Detecting Small Worlds in a Corpus of Thousands of Theater Plays” <span id="id9">[<a class="reference internal" href="bibliography.html#id25" title="Peer Trilcke, Eugenia Ustinova, Ingo Börner, Frank Fischer, and Carsten Milling. Detecting Small Worlds in a Corpus of Thousands of Theater Plays. A DraCor Study in Comparative Literary Network Analysis. In Melanie Andresen and Nils Reiter, editors, Computational Drama Analysis: Reflecting Methods and Interpretations. De Gruyter, Boston, 2024.">Trilcke <em>et al.</em>, 2024</a>]</span>. In this study, we tested different operationalizations of the so-called “Small World” concept based on a multilingual “Very Big Drama Corpus” (VeBiDraCor) of almost 3,000 theater plays. As explained above, the corpora available on DraCor are “living corpora” – which means that both the number of text files contained and the information contained in the text files changes (e.g. with regard to metadata or mark-up). This poses an additional challenge for reproducing our study. Furthermore, our analysis script (written in R) retrieves metadata and network metrics from the REST API of the “programmable corpus”. Thus, we had to devise a way of not only stabilizing the corpus but also the API.</p>
<p>DraCor provides Docker images for its services, which are, at its core the API, a frontend, a metrics service, that does the calculation of the network metrics of co-presence networks of the plays, and a triple store. The ready-made Docker images can be used to set up a local DraCor environment.<a class="footnote-reference brackets" href="#dracor-docker-images" id="id10" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a></p>
<p>For VeBiDraCor we devised a workflow that spins up a Docker container from a versioned bare Docker image of the DraCor database<a class="footnote-reference brackets" href="#vebidracor-image" id="id11" role="doc-noteref"><span class="fn-bracket">[</span>7<span class="fn-bracket">]</span></a> and ingests the data of the plays downloaded (“pulled”) from specified GitHub commits using a Python script<a class="footnote-reference brackets" href="#vebidracor-data-ingested" id="id12" role="doc-noteref"><span class="fn-bracket">[</span>8<span class="fn-bracket">]</span></a>. We then committed this container with <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">commit</span></code><a class="footnote-reference brackets" href="#commit-vebidracor-container" id="id13" role="doc-noteref"><span class="fn-bracket">[</span>9<span class="fn-bracket">]</span></a> to create a ready to use <a class="reference external" href="https://hub.docker.com/layers/ingoboerner/vebidracor-api/3.0.0/images/sha256-0b39f125534f7583bbb18b58379eb98312040eb04dd74548fb563d916a172d4c?context=explore">Docker image of the populated database and API</a> (see  <a class="reference internal" href="#frontend-loaded-vebidracor"><span class="std std-numref">Fig. 8</span></a>).</p>
<figure class="align-default" id="frontend-loaded-vebidracor">
<a class="reference internal image-reference" href="_images/frontend_loaded_vebidracor.png"><img alt="_images/frontend_loaded_vebidracor.png" src="_images/frontend_loaded_vebidracor.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 8 </span><span class="caption-text">Frontend of the local DraCor infrastructrue with added corpus VeBiDraCor</span><a class="headerlink" href="#frontend-loaded-vebidracor" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Because the build process is modular and documented in a Dockerfile, it is also possible to quickly change the API’s base image or the composition of the corpus by editing a manifest file that controls which plays from which repositories at which state are included.</p>
<p>In a second step, we also dockerized the research environment: a Docker container running <a class="reference external" href="https://posit.co/products/open-source/rstudio">RStudio</a> to which we added our <a class="reference external" href="https://github.com/dracor-org/small-world-paper/blob/ddf85c6a5c5d32004439520e6d5984cb40d7bad3/smallworlds-script.R">analysis script</a>. The preparation of this image is documented in a <a class="reference external" href="https://github.com/dracor-org/small-world-paper/blob/5622479f8649be81e3fa50bf8cc9ce5d3d44da5d/Dockerfile">Dockerfile</a>. As base image we used an image of the <a class="reference external" href="https://rocker-project.org/">rocker-project</a>. We used <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">commit</span></code> to “freeze” this state of our system and published all images. We call this state the “pre-analysis state”, which is documented in a <a class="reference external" href="https://github.com/dracor-org/small-world-paper/blob/bef7eadef788775a8b0a8e8351ff9d5249cbb65f/docker-compose.pre.yml">Docker Compose file</a>.</p>
<p>After we ran the analysis, we again created an image of the RStudio container with <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">commit</span></code>, thus turning it into a Docker image in which basically “froze” the state of the research environment after the R-script was run. The <a class="reference external" href="https://hub.docker.com/layers/ingoboerner/smallworld-rstudio/dcac262/images/sha256-03bec767bdc213a002783e2d0b34d896dce308ddfc243b90ef13b9292a972c54?context=explore">image of this “post-analysis state”</a> was also published on the DockerHub repository. It allows for inspection and verification of the results of our study in the same environment that we used (see <a class="reference internal" href="#rstudio-post-analysis-state"><span class="std std-numref">Fig. 9</span></a>).<a class="footnote-reference brackets" href="#smallworld-code-repo" id="id14" role="doc-noteref"><span class="fn-bracket">[</span>10<span class="fn-bracket">]</span></a></p>
<figure class="align-default" id="rstudio-post-analysis-state">
<a class="reference internal image-reference" href="_images/rstudio_post-analysis-state.png"><img alt="_images/rstudio_post-analysis-state.png" src="_images/rstudio_post-analysis-state.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 9 </span><span class="caption-text">RStudio after the analysis was run</span><a class="headerlink" href="#rstudio-post-analysis-state" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>By having these images representing two moments in the course of our analysis, we not only make our analysis transparent, we also allow for different scenarios of repeating our research. For example, starting an environment with the Docker Compose file that documents the “pre-analysis state” would allow a researcher to exactly repeat our analysis by re-running the script on the exact same data.</p>
<p>But also other scenarios of repeating research (e.g. “replication”, “reproduction”, “revision”, “reanalysis”, “reinvestigation”; cf. <span id="id15">[<a class="reference internal" href="bibliography.html#id6" title="Christof Schöch. Repetitive research: a conceptual space and terminology of replication, reproduction, revision, reanalysis, reinvestigation and reuse in digital humanities. International Journal of Digital Humanities, 5(2-3):373–403, November 2023. URL: https://link.springer.com/10.1007/s42803-023-00073-y (visited on 2024-02-26), doi:10.1007/s42803-023-00073-y.">Schöch, 2023</a>]</span>) could be implemented easily. To give one example: A researcher could adapt the Jupyter Notebook we used to assemble “VeBiDraCor” and create an image of the local corpus container the same way we did. By changing a single line in the Docker Compose file documenting the “pre-analysis state” it is possible to start the whole system with this different data. For running our R-script to analyze this data he or she could still use a container created from our RStudio image and thus run the analysis the exact same way we did, but on different data.</p>
<p>The following code cell demonstrates how to re-create the intrastructure that was used to generate the results reported in the paper.<a class="footnote-reference brackets" href="#run-docker-commands-in-notebook" id="id16" role="doc-noteref"><span class="fn-bracket">[</span>11<span class="fn-bracket">]</span></a></p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">script</span> bash --bg

# Clone the GitHub repository containing the data of the study

git clone https://github.com/dracor-org/small-world-paper.git

# Go into the just downloaded repository and switch to the branch &quot;publication-version&quot;

cd small-world-paper
git checkout publication-version

# Start the infrastructure in the &quot;post-analysis-state&quot; as defined 
# in the Compose file &quot;docker-compose.post.yml&quot;

docker compose -f docker-compose.post.yml up 
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>

# To see the status of the containers
# the STATUS of the container derived from the image ingoboerner/vebidracor-api:3.0.0 should be &quot;Up&quot;

docker ps -a
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CONTAINER ID   IMAGE                                      COMMAND                  CREATED                  STATUS                   PORTS                    NAMES
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c8be87a4cfb1   ingoboerner/dracor-frontend:v1.4.3_local   &quot;/docker-entrypoint.…&quot;   Less than a second ago   Created                                           small-world-paper-frontend-1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>74ec2b952ffd   ingoboerner/smallworld-rstudio:dcac262     &quot;/init&quot;                  Less than a second ago   Created                                           small-world-paper-rstudio-1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>633f3176788e   ingoboerner/vebidracor-api:3.0.0           &quot;java org.exist.star…&quot;   Less than a second ago   Created                                           small-world-paper-api-1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9c91409e298c   dracor/dracor-frontend:v1.6.0-dirty        &quot;/docker-entrypoint.…&quot;   4 minutes ago            Up 4 minutes             0.0.0.0:8088-&gt;80/tcp     chiasmus_detection-frontend-1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c9cef3212e75   dracor/dracor-api:v0.90.1-local            &quot;./entrypoint.sh&quot;        4 minutes ago            Up 4 minutes (healthy)   0.0.0.0:8080-&gt;8080/tcp   chiasmus_detection-api-1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>f2e4c6da0e08   dracor/dracor-metrics:v1.2.0               &quot;pipenv run hug -f m…&quot;   4 minutes ago            Up 4 minutes             0.0.0.0:8030-&gt;8030/tcp   chiasmus_detection-metrics-1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>307487cc4a2c   dracor/dracor-fuseki:v1.0.0                &quot;/usr/bin/tini -- /e…&quot;   4 minutes ago            Up 4 minutes             0.0.0.0:3030-&gt;3030/tcp   chiasmus_detection-fuseki-1
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="simplifying-the-workflow-stabledracor">
<span id="section-4-3"></span><h2>4.3 Simplifying the Workflow: StableDraCor<a class="headerlink" href="#simplifying-the-workflow-stabledracor" title="Link to this heading">#</a></h2>
<p>The workflow presented in the section <a class="reference internal" href="#section-4-2"><span class="std std-ref">4.2 Case Study: Dockerizing a Complete CLS Study</span></a> above is still quite complex. There are multiple steps involved to set-up the locally running infrastructure some of which need to be run from the command line. In addition, one has to create a bare container with a database and an API, populate it with the data, conduct the analysis, create several Docker images, and, ultimately, publish them in a repository, e.g. on DockerHub. There is also the need to create the Docker Compose file that specifies which system components are needed to recreate the environment the analysis was run in at different points in time. Thus, there is a considerable need to make the process more user-friendly.</p>
<p>Our approach to simplifying the process focuses on developing a Python package called “StableDraCor” that makes the setting-up of local DraCor instances and populating them with data easier by somewhat “hiding” the complexity of the Docker and Docker Compose commands. While there is no real need for a generic tool managing containers and images (because this can be done with <a class="reference external" href="https://www.docker.com/products/docker-desktop">Docker Desktop</a>), with “StableDraCor” we address the complexity of setting up the specific DraCor infrastructure components and loading DraCor corpora (or a subset thereof).</p>
<p>In the following, we describe the workflow using the tool. The package can be built and installed from the <a class="reference external" href="https://github.com/dracor-org/stabledracor">GitHub repository</a><a class="footnote-reference brackets" href="#stabledracor-dev-version" id="id17" role="doc-noteref"><span class="fn-bracket">[</span>12<span class="fn-bracket">]</span></a>.</p>
<div class="cell tag_hide-cell tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>

# Clone the repository
# The target directory is outside of the current working directory &quot;report&quot;

git clone https://github.com/ingoboerner/stable-dracor.git /home/d73/stable-dracor

# Switch into repository and checkout a commit 
# We checkout the commit because the package is still in development and we want to install a
# certain version to be used here
# the -c option is optional; it suppresses a warning about git being in so-called detached head state

cd /home/d73/stable-dracor
git -c advice.detachedHead=false checkout df31c4e

# install the package

pip install .

# cleanup: remove the previously cloned repository
cd /home/d73/report
rm -rf /home/d73/stable-dracor
</pre></div>
</div>
</div>
</details>
</div>
<p>After initializing a StableDraCor instance, the infrastructure can be started with a single command <code class="docutils literal notranslate"><span class="pre">run()</span></code>. If a user does not specify any parameters (like pointing to a designated custom local Docker Compose file) the script fetches a configuration of the system specified by a <a class="reference external" href="https://github.com/dracor-org/stabledracor/blob/2dc461e6f3d8106f5291ba0b1f6779b7adb52c5d/configurations/compose.fullstack.empty.yml">Docker Compose file</a> (<code class="docutils literal notranslate"><span class="pre">compose.fullstack.yml</span></code>) and starts the defined containers.</p>
<div class="cell tag_remove-output tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the package</span>
<span class="kn">from</span> <span class="nn">stabledracor.client</span> <span class="kn">import</span> <span class="n">StableDraCor</span>

<span class="c1"># Use a GitHub Personal Access Token, see </span>
<span class="c1"># https://github.com/ingoboerner/stable-dracor/blob/e300d77c419537538b4d491a8bbe2b9449123131/notebooks/03_faq.ipynb</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="n">github_token</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;GITHUB_TOKEN&quot;</span><span class="p">)</span>

<span class="c1"># Initialize a local DraCor infrastructure</span>
<span class="c1"># Provide metadata like a &quot;name&quot; and a description</span>

<span class="n">local_dracor</span> <span class="o">=</span> <span class="n">StableDraCor</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my_local_dracor&quot;</span><span class="p">,</span> 
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;My local demo DraCor system&quot;</span><span class="p">,</span>
    <span class="n">github_access_token</span><span class="o">=</span><span class="n">github_token</span>
<span class="p">)</span>

<span class="c1"># Start the infrastructure</span>

<span class="n">local_dracor</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>After running the above cell in the “Executeable Report” the local DraCor frontend becomes available at <a class="reference external" href="http://localhost:8088">http://localhost:8088</a>. As can be seen in <a class="reference internal" href="#local-dracor-frontend-empty"><span class="std std-ref">Frontend of the local DraCor infrastructure with no corpora loaded</span></a> no corpora have been loaded yet.</p>
<figure class="align-default" id="local-dracor-frontend-empty">
<a class="reference internal image-reference" href="_images/local_dracor_frontend_empty.png"><img alt="_images/local_dracor_frontend_empty.png" src="_images/local_dracor_frontend_empty.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 10 </span><span class="caption-text">Frontend of the local DraCor infrastructure with no corpora loaded</span><a class="headerlink" href="#local-dracor-frontend-empty" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The package supports setting-up local custom corpora either by copying a corpus or parts thereof from any running DraCor system, for example the <a class="reference external" href="https://dracor.org">production system</a> or the <a class="reference external" href="https://staging.dracor.org">staging server</a>, containing even more corpora that are currently prepared for publication.</p>
<p>In the following code cell the “Tatar Drama Corpus” from the production instance of DraCor to the local database (see <a class="reference internal" href="#local-dracor-frontend-empty"><span class="std std-ref">Frontend of the local DraCor infrastructure with no corpora loaded</span></a>).</p>
<div class="cell tag_hide-cell tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">local_dracor</span><span class="o">.</span><span class="n">copy_corpus</span><span class="p">(</span><span class="n">source_corpusname</span><span class="o">=</span><span class="s2">&quot;tat&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>After executing the command in the code cell above there will be a single corpus in the <a class="reference external" href="http://localhost:8088">local DraCor instance</a> (see <a class="reference internal" href="#local-dracor-tatdracor"><span class="std std-ref">Frontend of the local DraCor infrastructure with the “Tatar Drama Corpus” loaded</span></a>) that is a copy of the data currently available at <a class="reference external" href="https://dracor.org/tat">https://dracor.org/tat</a>.</p>
<figure class="align-default" id="local-dracor-tatdracor">
<a class="reference internal image-reference" href="_images/local_dracor_tatdracor.png"><img alt="_images/local_dracor_tatdracor.png" src="_images/local_dracor_tatdracor.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 11 </span><span class="caption-text">Frontend of the local DraCor infrastructure with the “Tatar Drama Corpus” loaded</span><a class="headerlink" href="#local-dracor-tatdracor" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>It is also possible to directly add TEI files from the local filesystem, which allows a user to even use the DraCor environment with data not published on <a class="reference external" href="https://dracor.org">dracor.org</a> or a public GitHub repository. When adding data to a local Docker container with the help of the “StableDraCor” package, the program keeps track of the constitution of the corpora and the sources used.</p>
<p>In the following code cell a single file is imported into the custom local corpus “FilesDraCor” (see <a class="reference internal" href="#local-dracor-filesdracor"><span class="std std-ref">Frontend of the local DraCor infrastructure with the additionally loaded file in the corpus “FilesDraCor”</span></a>).</p>
<div class="cell tag_hide-cell tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a corpus &quot;FilesDraCor&quot; and add a single play from the folder &quot;import&quot; to it</span>

<span class="n">local_dracor</span><span class="o">.</span><span class="n">add_plays_from_directory</span><span class="p">(</span>
    <span class="n">corpusname</span><span class="o">=</span><span class="s2">&quot;files&quot;</span><span class="p">,</span>
    <span class="n">directory</span><span class="o">=</span><span class="s2">&quot;../import/&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>ls<span class="w"> </span>../import
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>lessing-emilia-galotti.xml
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="local-dracor-filesdracor">
<a class="reference internal image-reference" href="_images/local_dracor_filesdracor.png"><img alt="_images/local_dracor_filesdracor.png" src="_images/local_dracor_filesdracor.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 12 </span><span class="caption-text">Frontend of the local DraCor infrastructure with the additionally loaded file in the corpus “FilesDraCor”</span><a class="headerlink" href="#local-dracor-filesdracor" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>To allow for better reproducibility of the local infratructure it is recommended to used the functionality to to directly load corpora or parts thereof from a GitHub repository. This method of adding data allows to specify the “version” of the data in the corpus compilation process at a given point in time by referring to a single GitHub commit. As mentioned above, because DraCor corpora are “living corpora”, it is not guaranteed that corpora that are available on the web platform do not change. Therefore, it would not be a good idea to base research aiming at being repeatable at the data in the live system. By using data directly from GitHub with StableDraCor it is possible to include only the plays that were available, let’s say, two years ago and in the encoding state they were at this time.</p>
<p>In the following code cell the “Bashkir Drama Corpus” is added to the local database directly from its GitHub Repository.</p>
<div class="cell tag_hide-cell tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add the Bashkir Drama Corpus from GitHub in the version identified by a single commit</span>

<span class="n">local_dracor</span><span class="o">.</span><span class="n">add_corpus_from_repo</span><span class="p">(</span>
    <span class="n">repository_name</span><span class="o">=</span><span class="s2">&quot;bashdracor&quot;</span><span class="p">,</span> 
    <span class="n">commit</span><span class="o">=</span><span class="s2">&quot;c16b58ef3726a63c431bb9575b682c165c9c0cbd&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The local DraCor infrastructure that has been set up until this point can be explored at <a class="reference external" href="http://localhost:8088">http://localhost:8088</a> (see <a class="reference internal" href="#local-dracor-3-corpora"><span class="std std-ref">Frontend of the local DraCor infrastructure with three corpora including the “Bashkir Drama Corpus”</span></a>.</p>
<figure class="align-default" id="local-dracor-3-corpora">
<a class="reference internal image-reference" href="_images/local_dracor_3_corpora.png"><img alt="_images/local_dracor_3_corpora.png" src="_images/local_dracor_3_corpora.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 13 </span><span class="caption-text">Frontend of the local DraCor infrastructure with three corpora including the “Bashkir Drama Corpus”</span><a class="headerlink" href="#local-dracor-3-corpora" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The tool keeps track of the whole configuration of the system: This includes the versions of the microservices used, and the corpora loaded. The state of the corpus is identified by a timestamp and – if the source is a GitHub repository, the commit. This “log” can be output as a “manifest” JSON object (command: <code class="docutils literal notranslate"><span class="pre">get_manifest()</span></code>), which should allow re-creating the system even if no Docker image is available. It would also allow a user to unambiguously identify the exact data that was used in a study.<a class="footnote-reference brackets" href="#manifest-as-single-source-of-truth" id="id18" role="doc-noteref"><span class="fn-bracket">[</span>13<span class="fn-bracket">]</span></a></p>
<p>The following code snippet shows such a manifest<a class="footnote-reference brackets" href="#manifest-explained" id="id19" role="doc-noteref"><span class="fn-bracket">[</span>14<span class="fn-bracket">]</span></a> with several corpora added:</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Output the manifest documenting the local DraCor System</span>

<span class="n">local_dracor</span><span class="o">.</span><span class="n">get_manifest</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;version&#39;: &#39;v1&#39;,
 &#39;system&#39;: {&#39;id&#39;: &#39;da0980c8-0ed9-4120-9f72-6989906435b6&#39;,
  &#39;name&#39;: &#39;my_local_dracor&#39;,
  &#39;description&#39;: &#39;My local demo DraCor system&#39;,
  &#39;timestamp&#39;: &#39;2024-04-29T07:24:12.185273&#39;},
 &#39;services&#39;: {&#39;api&#39;: {&#39;container&#39;: &#39;9508a2c75338&#39;,
   &#39;image&#39;: &#39;dracor/dracor-api:v0.90.1-local&#39;,
   &#39;version&#39;: &#39;0.90.1-2-g19a3f46-dirty&#39;,
   &#39;existdb&#39;: &#39;6.0.1&#39;},
  &#39;frontend&#39;: {&#39;container&#39;: &#39;5cdeab5eb2c2&#39;,
   &#39;image&#39;: &#39;dracor/dracor-frontend:v1.6.0-dirty&#39;},
  &#39;metrics&#39;: {&#39;container&#39;: &#39;3e39341abb86&#39;,
   &#39;image&#39;: &#39;dracor/dracor-metrics:v1.2.0&#39;},
  &#39;triplestore&#39;: {&#39;container&#39;: &#39;e054e879593f&#39;,
   &#39;image&#39;: &#39;dracor/dracor-fuseki:v1.0.0&#39;}},
 &#39;corpora&#39;: {&#39;tat&#39;: {&#39;corpusname&#39;: &#39;tat&#39;,
   &#39;timestamp&#39;: &#39;2024-04-29T07:23:57.313767&#39;,
   &#39;sources&#39;: {&#39;tat&#39;: {&#39;type&#39;: &#39;api&#39;,
     &#39;corpusname&#39;: &#39;tat&#39;,
     &#39;url&#39;: &#39;https://dracor.org/api/corpora/tat&#39;,
     &#39;timestamp&#39;: &#39;2024-04-29T07:23:57.313775&#39;,
     &#39;num_of_plays&#39;: 3}},
   &#39;num_of_plays&#39;: 3},
  &#39;files&#39;: {&#39;corpusname&#39;: &#39;files&#39;,
   &#39;timestamp&#39;: &#39;2024-04-29T07:24:02.373231&#39;,
   &#39;sources&#39;: {&#39;fd55d6f8&#39;: {&#39;type&#39;: &#39;files&#39;,
     &#39;timestamp&#39;: &#39;2024-04-29T07:24:02.373238&#39;}},
   &#39;num_of_plays&#39;: 1},
  &#39;bash&#39;: {&#39;corpusname&#39;: &#39;bash&#39;,
   &#39;timestamp&#39;: &#39;2024-04-29T07:24:06.675530&#39;,
   &#39;sources&#39;: {&#39;bash&#39;: {&#39;type&#39;: &#39;repository&#39;,
     &#39;corpusname&#39;: &#39;bash&#39;,
     &#39;url&#39;: &#39;https://github.com/dracor-org/bashdracor&#39;,
     &#39;commit&#39;: &#39;c16b58ef3726a63c431bb9575b682c165c9c0cbd&#39;,
     &#39;timestamp&#39;: &#39;2024-04-29T07:24:06.675539&#39;,
     &#39;num_of_plays&#39;: 3}},
   &#39;num_of_plays&#39;: 3}}}
</pre></div>
</div>
</div>
</div>
<p>“StableDraCor” supports creating a Docker image from a populated database container. With the original workflow it was necessary to do this with the <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">commit</span></code> command in the terminal. It was also necessary to provide additional documentation, for example the Jupyter notebook that was used to assemble a corpus. This information was ‘detached’ from the Docker image and it was necessary to explicitly point to this form of documentation, because it was not part of the research artifact itself. We tackled this issue with StableDracor and found a way to include machine readable documentation <em>about</em> the research artifact directly <em>attached</em> to it. Now, when we create an image with the tool, we issue a slightly different <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">commit</span></code> command that also attaches Docker Object Labels<a class="footnote-reference brackets" href="#docker-object-labels" id="id20" role="doc-noteref"><span class="fn-bracket">[</span>15<span class="fn-bracket">]</span></a> directly to the newly created image. We achieve this by taking the manifest as mentioned earlier, and decomposing it into single Docker Labels. StableDraCor can convert a manifest into labels but also re-convert Docker Object Labels on the image in the <code class="docutils literal notranslate"><span class="pre">org.dracor.stable-dracor.*</span></code> namespace back into a manifest. By providing the manifest information as image labels, we allow a user, for example, to retrieve information about the corpus contents and the sources of a database without having to run the image as a Docker container first. We also attach the information about the individual DraCor microservices directly to the image as labels.</p>
<p>In the following code cell a Docker Image of the the DraCor API container is created.</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a Docker image of the DraCor API container</span>

<span class="n">local_dracor</span><span class="o">.</span><span class="n">create_docker_image_of_service</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> 
                                            <span class="n">image_tag</span><span class="o">=</span><span class="s2">&quot;d73_demo&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:root:The dracor-api container is running. There might be issues with the image, if it is create from a running container. Consider stopping it before creating the image.
</pre></div>
</div>
</div>
</details>
</div>
<p>The labels attached to this image are as follows:</p>
<div class="cell tag_remove-input tag_hide-cell docutils container">
<details class="hide above-output">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell outputs</span>
<span class="expanded">Hide code cell outputs</span>
</summary>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;com.docker.compose.config-hash&#39;: &#39;2b3dcea466df52b1886c275c872b8b2aacf2b3646ddec2a6dee7a2bf2e6b6535&#39;,
 &#39;com.docker.compose.container-number&#39;: &#39;1&#39;,
 &#39;com.docker.compose.depends_on&#39;: &#39;fuseki:service_started:false,metrics:service_started:false&#39;,
 &#39;com.docker.compose.image&#39;: &#39;sha256:171df59ae0ab650356c45feeabe2a65b63b77c3e9bd7bf362926bfdd78e931f8&#39;,
 &#39;com.docker.compose.oneoff&#39;: &#39;False&#39;,
 &#39;com.docker.compose.project&#39;: &#39;my_local_dracor&#39;,
 &#39;com.docker.compose.project.config_files&#39;: &#39;-&#39;,
 &#39;com.docker.compose.project.working_dir&#39;: &#39;/home/d73/report&#39;,
 &#39;com.docker.compose.service&#39;: &#39;api&#39;,
 &#39;com.docker.compose.version&#39;: &#39;2.23.0&#39;,
 &#39;org.dracor.stable-dracor.corpora&#39;: &#39;tat,files,bash&#39;,
 &#39;org.dracor.stable-dracor.corpora.bash.corpusname&#39;: &#39;bash&#39;,
 &#39;org.dracor.stable-dracor.corpora.bash.num-of-plays&#39;: &#39;3&#39;,
 &#39;org.dracor.stable-dracor.corpora.bash.sources&#39;: &#39;bash&#39;,
 &#39;org.dracor.stable-dracor.corpora.bash.sources.bash.commit&#39;: &#39;c16b58ef3726a63c431bb9575b682c165c9c0cbd&#39;,
 &#39;org.dracor.stable-dracor.corpora.bash.sources.bash.corpusname&#39;: &#39;bash&#39;,
 &#39;org.dracor.stable-dracor.corpora.bash.sources.bash.num-of-plays&#39;: &#39;3&#39;,
 &#39;org.dracor.stable-dracor.corpora.bash.sources.bash.timestamp&#39;: &#39;2024-04-29T07:24:06.675539&#39;,
 &#39;org.dracor.stable-dracor.corpora.bash.sources.bash.type&#39;: &#39;repository&#39;,
 &#39;org.dracor.stable-dracor.corpora.bash.sources.bash.url&#39;: &#39;https://github.com/dracor-org/bashdracor&#39;,
 &#39;org.dracor.stable-dracor.corpora.bash.timestamp&#39;: &#39;2024-04-29T07:24:06.675530&#39;,
 &#39;org.dracor.stable-dracor.corpora.files.corpusname&#39;: &#39;files&#39;,
 &#39;org.dracor.stable-dracor.corpora.files.num-of-plays&#39;: &#39;1&#39;,
 &#39;org.dracor.stable-dracor.corpora.files.sources&#39;: &#39;fd55d6f8&#39;,
 &#39;org.dracor.stable-dracor.corpora.files.sources.fd55d6f8.timestamp&#39;: &#39;2024-04-29T07:24:02.373238&#39;,
 &#39;org.dracor.stable-dracor.corpora.files.sources.fd55d6f8.type&#39;: &#39;files&#39;,
 &#39;org.dracor.stable-dracor.corpora.files.timestamp&#39;: &#39;2024-04-29T07:24:02.373231&#39;,
 &#39;org.dracor.stable-dracor.corpora.tat.corpusname&#39;: &#39;tat&#39;,
 &#39;org.dracor.stable-dracor.corpora.tat.num-of-plays&#39;: &#39;3&#39;,
 &#39;org.dracor.stable-dracor.corpora.tat.sources&#39;: &#39;tat&#39;,
 &#39;org.dracor.stable-dracor.corpora.tat.sources.tat.corpusname&#39;: &#39;tat&#39;,
 &#39;org.dracor.stable-dracor.corpora.tat.sources.tat.num-of-plays&#39;: &#39;3&#39;,
 &#39;org.dracor.stable-dracor.corpora.tat.sources.tat.timestamp&#39;: &#39;2024-04-29T07:23:57.313775&#39;,
 &#39;org.dracor.stable-dracor.corpora.tat.sources.tat.type&#39;: &#39;api&#39;,
 &#39;org.dracor.stable-dracor.corpora.tat.sources.tat.url&#39;: &#39;https://dracor.org/api/corpora/tat&#39;,
 &#39;org.dracor.stable-dracor.corpora.tat.timestamp&#39;: &#39;2024-04-29T07:23:57.313767&#39;,
 &#39;org.dracor.stable-dracor.services&#39;: &#39;api,frontend,metrics,triplestore&#39;,
 &#39;org.dracor.stable-dracor.services.api.base-image&#39;: &#39;dracor/dracor-api:v0.90.1-local&#39;,
 &#39;org.dracor.stable-dracor.services.api.existdb&#39;: &#39;6.0.1&#39;,
 &#39;org.dracor.stable-dracor.services.api.image&#39;: &#39;dracor/stable-dracor:d73_demo&#39;,
 &#39;org.dracor.stable-dracor.services.api.version&#39;: &#39;0.90.1-2-g19a3f46-dirty&#39;,
 &#39;org.dracor.stable-dracor.services.frontend.image&#39;: &#39;dracor/dracor-frontend:v1.6.0-dirty&#39;,
 &#39;org.dracor.stable-dracor.services.metrics.image&#39;: &#39;dracor/dracor-metrics:v1.2.0&#39;,
 &#39;org.dracor.stable-dracor.services.triplestore.image&#39;: &#39;dracor/dracor-fuseki:v1.0.0&#39;,
 &#39;org.dracor.stable-dracor.system.description&#39;: &#39;My local demo DraCor system&#39;,
 &#39;org.dracor.stable-dracor.system.id&#39;: &#39;da0980c8-0ed9-4120-9f72-6989906435b6&#39;,
 &#39;org.dracor.stable-dracor.system.name&#39;: &#39;my_local_dracor&#39;,
 &#39;org.dracor.stable-dracor.system.timestamp&#39;: &#39;2024-04-29T07:24:12.226746&#39;,
 &#39;org.dracor.stable-dracor.version&#39;: &#39;v1&#39;}
</pre></div>
</div>
</div>
</details>
</div>
<p>In summary, our “StableDraCor” package allows to generate a fully self-describing, completely versionized research artifact that alone is sufficient to replicate the corpora and their research infrastructure that were used in a study.</p>
</section>
<section id="practical-examples">
<span id="section-4-4"></span><h2>4.4 Practical Examples<a class="headerlink" href="#practical-examples" title="Link to this heading">#</a></h2>
<p>The following section demonstrates how the concepts and tools introduced in this report can be used to facilitate future repeating of research based on DraCor infrastructure components and corpora. The first example shows how to identify and then stabilize the exact version of the corpus used in a research paper that was discussed earlier in section <a class="reference internal" href="3-1_versioning_living_corpora.html#section-3-1"><span class="std std-ref">3.1 How to Better Not Cite a Living Corpus. An Example From Current Research</span></a>. In the second example a version of the “DLINA Corpus Sydney” is created on the basis of recent DraCor data to allow for repeating research carried out in the context of the DLINA project on the same set of plays.<a class="footnote-reference brackets" href="#dlina-research" id="id21" role="doc-noteref"><span class="fn-bracket">[</span>16<span class="fn-bracket">]</span></a></p>
<section id="reconstructing-and-stabilizing-corpora-used-to-train-and-evaluate-a-classifier-for-chiasmus-detection">
<span id="section-4-4-1"></span><h3>4.4.1 Reconstructing (and Stabilizing) Corpora Used to Train and Evaluate a Classifier for Chiasmus Detection<a class="headerlink" href="#reconstructing-and-stabilizing-corpora-used-to-train-and-evaluate-a-classifier-for-chiasmus-detection" title="Link to this heading">#</a></h3>
<p>In <a class="reference internal" href="3-1_versioning_living_corpora.html#section-3-1"><span class="std std-ref">3.1 How to Better Not Cite a Living Corpus. An Example From Current Research</span></a> the paper „Data-Driven Detection of General Chiasmi Using Lexical and Semantic Features“ <span id="id22">[<a class="reference internal" href="bibliography.html#id19" title="Felix Schneider, Björn Barz, Phillip Brandes, Sophie Marshall, and Joachim Denzler. Data-Driven Detection of General Chiasmi Using Lexical and Semantic Features. In Stefania Degaetano-Ortlieb, Anna Kazantseva, Nils Reiter, and Stan Szpakowicz, editors, Proceedings of the 5th Joint SIGHUM Workshop on Computational Linguistics for Cultural Heritage, Social Sciences, Humanities and Literature, 96–100. Punta Cana, Dominican Republic (online), November 2021. Association for Computational Linguistics. URL: https://aclanthology.org/2021.latechclfl-1.11, doi:10.18653/v1/2021.latechclfl-1.11.">Schneider <em>et al.</em>, 2021</a>]</span> is discussed as an example of research that re-uses the German Drama Corpus. The authors do not use the DraCor API for their study but download data directly from the GerDraCor GitHub Repository. The only information that hints at which version of the corpus was used to train and test the classifier is the number of plays that were included in the corpus at the time. The authors report that GerDraCor included 504 plays.</p>
<p>In the following code cells we use the “corpus archeology script” described in the section <a class="reference internal" href="3-2_gerdracor_corpus_archeology.html#excursus"><span class="std std-ref">Excursus: An Algorithmic Archaeology of a Living Corpus: GerDraCor as a Dynamic Epistemic Object</span></a> to identify the actual version of the German Drama Corpus used and load this version into a local DraCor infrastructure as described in section <a class="reference internal" href="#section-4-3"><span class="std std-ref">4.3 Simplifying the Workflow: StableDraCor</span></a>:</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Start the analysis with previously downloaded data</span>

<span class="n">repo</span> <span class="o">=</span> <span class="n">GitHubRepo</span><span class="p">(</span><span class="n">repository_name</span><span class="o">=</span><span class="s2">&quot;gerdracor&quot;</span><span class="p">,</span> 
                  <span class="n">github_access_token</span><span class="o">=</span><span class="n">github_token</span><span class="p">,</span>
                  <span class="n">import_commit_list</span><span class="o">=</span><span class="s2">&quot;tmp/gerdracor_commits.json&quot;</span><span class="p">,</span>
                  <span class="n">import_commit_details</span><span class="o">=</span><span class="s2">&quot;tmp/gerdracor_commits_detailed.json&quot;</span><span class="p">,</span>
                  <span class="n">import_data_folder_objects</span><span class="o">=</span><span class="s2">&quot;tmp/gerdracor_data_folder_objects.json&quot;</span><span class="p">,</span>
                  <span class="n">import_corpus_versions</span><span class="o">=</span><span class="s2">&quot;tmp/gerdracor_corpus_versions.json&quot;</span><span class="p">)</span>

<span class="c1"># To get the version with 504 plays:</span>
<span class="c1"># Get the versions as a dataframe containing the number of plays included (&quot;document_count&quot;)</span>

<span class="n">play_counts_df</span> <span class="o">=</span> <span class="n">repo</span><span class="o">.</span><span class="n">get_corpus_versions_as_df</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span><span class="s2">&quot;date_from&quot;</span><span class="p">,</span><span class="s2">&quot;document_count&quot;</span><span class="p">])</span>

<span class="c1"># Filter the dataframe on versions that have exactly 504 plays</span>
<span class="n">play_counts_df</span><span class="p">[</span><span class="n">play_counts_df</span><span class="p">[</span><span class="s2">&quot;document_count&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">504</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>date_from</th>
      <th>document_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1212</th>
      <td>6e1020dcfcb98a0d027ceb401a6a5fbd4537fe29</td>
      <td>2020-09-26 11:47:04+00:00</td>
      <td>504</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<p>The most probable version of the GerDraCor data used is identified by the SHA value <span class="pasted-text">6e1020dcfcb98a0d027ceb401a6a5fbd4537fe29</span> and dates from <span class="pasted-text">26 September, 2020</span>.<a class="footnote-reference brackets" href="#sighum5" id="id23" role="doc-noteref"><span class="fn-bracket">[</span>17<span class="fn-bracket">]</span></a> In the following cell a Docker container of the DraCor API is created and populated with this exact corpus version (see <a class="reference internal" href="#local-dracor-504-gerdracor-plays"><span class="std std-ref">Frontend of the local DraCor infrastructure with GerDraCor (version: 6e1020dcfcb98a0d027ceb401a6a5fbd4537fe29) including 504 plays</span></a>):</p>
<div class="cell tag_hide-cell tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize the StableDraCor instance; add metadata</span>

<span class="n">chiasmus_detection_dracor</span> <span class="o">=</span> <span class="n">StableDraCor</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;chiasmus_detection&quot;</span><span class="p">,</span> 
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;DraCor system including the GerDraCor version used in the paper &#39;Data-Driven Detection of General Chiasmi&#39;&quot;</span><span class="p">,</span>
    <span class="n">github_access_token</span><span class="o">=</span><span class="n">github_token</span>
<span class="p">)</span>

<span class="c1"># Run the infrastructure</span>

<span class="n">chiasmus_detection_dracor</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1"># Add the corpus version</span>
<span class="c1"># Because data is ingested (which is a slow process) this will take some time (approx. 30min!)</span>
<span class="c1"># Be very patient. You can check http://localhost:8088 to see the progress. The number of plays</span>
<span class="c1"># in the corpus should constantly increase when reloading the page.</span>

<span class="n">chiasmus_version_commit_id</span> <span class="o">=</span> <span class="n">play_counts_df</span><span class="p">[</span><span class="n">play_counts_df</span><span class="p">[</span><span class="s2">&quot;document_count&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">504</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>

<span class="n">chiasmus_detection_dracor</span><span class="o">.</span><span class="n">add_corpus_from_repo</span><span class="p">(</span>
    <span class="n">repository_name</span><span class="o">=</span><span class="s2">&quot;gerdracor&quot;</span><span class="p">,</span> 
    <span class="n">commit</span><span class="o">=</span><span class="n">chiasmus_version_commit_id</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="local-dracor-504-gerdracor-plays">
<a class="reference internal image-reference" href="_images/local_dracor_504_gerdracor_plays.png"><img alt="_images/local_dracor_504_gerdracor_plays.png" src="_images/local_dracor_504_gerdracor_plays.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 14 </span><span class="caption-text">Frontend of the local DraCor infrastructure with GerDraCor (version: 6e1020dcfcb98a0d027ceb401a6a5fbd4537fe29) including 504 plays</span><a class="headerlink" href="#local-dracor-504-gerdracor-plays" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>For training of the classifier a manually annotated data set consisting of four plays by the author Friedrich Schiller are used (cf. <span id="id24">[<a class="reference internal" href="bibliography.html#id19" title="Felix Schneider, Björn Barz, Phillip Brandes, Sophie Marshall, and Joachim Denzler. Data-Driven Detection of General Chiasmi Using Lexical and Semantic Features. In Stefania Degaetano-Ortlieb, Anna Kazantseva, Nils Reiter, and Stan Szpakowicz, editors, Proceedings of the 5th Joint SIGHUM Workshop on Computational Linguistics for Cultural Heritage, Social Sciences, Humanities and Literature, 96–100. Punta Cana, Dominican Republic (online), November 2021. Association for Computational Linguistics. URL: https://aclanthology.org/2021.latechclfl-1.11, doi:10.18653/v1/2021.latechclfl-1.11.">Schneider <em>et al.</em>, 2021</a>, p.98]</span>; citations can also be found in <a class="reference internal" href="3-1_versioning_living_corpora.html#section-3-1"><span class="std std-ref">3.1 How to Better Not Cite a Living Corpus. An Example From Current Research</span></a>) In the paper the titles of these plays are included. In the following list DraCor identifiers are added:</p>
<ul class="simple">
<li><p><em>Die Piccolomini</em> (<code class="docutils literal notranslate"><span class="pre">schiller-die-piccolomini</span></code>, <a class="reference external" href="https://dracor.org/id/ger000086">ger000086</a>)</p></li>
<li><p><em>Wallensteins Lager</em> (<code class="docutils literal notranslate"><span class="pre">schiller-wallensteins-lager</span></code>, <a class="reference external" href="https://dracor.org/id/ger000025">ger000025</a>)</p></li>
<li><p><em>Wallensteins Tod</em> (<code class="docutils literal notranslate"><span class="pre">schiller-wallensteins-tod</span></code>, <a class="reference external" href="https://dracor.org/id/ger000058">ger000058</a>)</p></li>
<li><p><em>Wilhelm Tell</em> (<code class="docutils literal notranslate"><span class="pre">schiller-wilhelm-tell</span></code>, <a class="reference external" href="https://dracor.org/id/ger000452">ger000452</a>)</p></li>
</ul>
<div class="cell tag_remove-output tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># [...] four annotated texts by Friedrich Schiller</span>
<span class="c1"># Die Piccolomini, </span>
<span class="c1"># Wallensteins Lager, </span>
<span class="c1"># Wallensteins Tod </span>
<span class="c1"># and Wilhelm Tell.</span>

<span class="c1"># Add an empty new corpus &quot;training&quot; with the following metadata</span>

<span class="n">chiasmus_annotated_corpus_metadata</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;training&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Schiller Training Corpus&quot;</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Corpus of four plays by Friedrich Schiller used to train the Chiasmus Classifier&quot;</span>
<span class="p">}</span>

<span class="n">chiasmus_detection_dracor</span><span class="o">.</span><span class="n">add_corpus</span><span class="p">(</span><span class="n">corpus_metadata</span><span class="o">=</span><span class="n">chiasmus_annotated_corpus_metadata</span><span class="p">)</span>

<span class="c1"># Create a list with the playnames/filenames of the plays to add</span>

<span class="n">chiasmus_annotated_schiller_corpus_playnames</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;schiller-die-piccolomini&quot;</span><span class="p">,</span>
    <span class="s2">&quot;schiller-wallensteins-lager&quot;</span><span class="p">,</span>
    <span class="s2">&quot;schiller-wallensteins-tod&quot;</span><span class="p">,</span>
    <span class="s2">&quot;schiller-wilhelm-tell&quot;</span><span class="p">]</span>

<span class="c1"># Add each play in the respective version to the previously created corpus</span>

<span class="k">for</span> <span class="n">playname</span> <span class="ow">in</span> <span class="n">chiasmus_annotated_schiller_corpus_playnames</span><span class="p">:</span>
    <span class="n">chiasmus_detection_dracor</span><span class="o">.</span><span class="n">add_play_version_to_corpus</span><span class="p">(</span>
        <span class="n">filename</span><span class="o">=</span><span class="n">playname</span><span class="p">,</span>
        <span class="n">repository_name</span><span class="o">=</span><span class="s2">&quot;gerdracor&quot;</span><span class="p">,</span>
        <span class="n">commit</span><span class="o">=</span><span class="n">chiasmus_version_commit_id</span><span class="p">,</span>
        <span class="n">corpusname</span><span class="o">=</span><span class="s2">&quot;training&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The classifier is then tested on a data set consisting of the other seven plays by Friedrich Schiller included in the GerDraCor corpus at that time. The authors do not explicitly spell out the titles but with having the <a class="reference external" href="https://localhost:8088/ger">local instance of GerDraCor</a> one can filter for the plays by Schiller or even use the API to filter out plays by a certain author (identified by a Wikidata Identfier, here: <a class="reference external" href="https://wikidata.org/entity/Q22670">Q22670</a>) as is demonstrated in the following hidden code cell. We use this information to create an additional corpus <code class="docutils literal notranslate"><span class="pre">test</span></code> in the local DraCor instance.</p>
<div class="cell tag_hide-cell tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># [...] seven other dramas by Friedrich Schiller [...]</span>

<span class="c1"># Add an empty new corpus &quot;test&quot; with the following metadata</span>

<span class="n">chiasmus_test_corpus_metadata</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Schiller Test Corpus&quot;</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Corpus of the seven other plays by Friedrich Schiller used to test the Chiasmus Classifier&quot;</span>
<span class="p">}</span>

<span class="n">chiasmus_detection_dracor</span><span class="o">.</span><span class="n">add_corpus</span><span class="p">(</span><span class="n">corpus_metadata</span><span class="o">=</span><span class="n">chiasmus_test_corpus_metadata</span><span class="p">)</span>

<span class="c1"># Create a list with the playnames/filenames of the plays to add</span>

<span class="n">chiasmus_schiller_testset_playnames</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;schiller-maria-stuart&quot;</span><span class="p">,</span>
    <span class="s2">&quot;schiller-kabale-und-liebe&quot;</span><span class="p">,</span>
    <span class="s2">&quot;schiller-don-carlos-infant-von-spanien&quot;</span><span class="p">,</span>
    <span class="s2">&quot;schiller-die-verschwoerung-des-fiesco-zu-genua&quot;</span><span class="p">,</span>
    <span class="s2">&quot;schiller-die-raeuber&quot;</span><span class="p">,</span>
    <span class="s2">&quot;schiller-die-jungfrau-von-orleans&quot;</span><span class="p">,</span>
    <span class="s2">&quot;schiller-die-braut-von-messina&quot;</span><span class="p">]</span>

<span class="c1"># Add each play in the respective version to the previously created corpus</span>

<span class="k">for</span> <span class="n">playname</span> <span class="ow">in</span> <span class="n">chiasmus_schiller_testset_playnames</span><span class="p">:</span>
    <span class="n">chiasmus_detection_dracor</span><span class="o">.</span><span class="n">add_play_version_to_corpus</span><span class="p">(</span>
        <span class="n">filename</span><span class="o">=</span><span class="n">playname</span><span class="p">,</span>
        <span class="n">repository_name</span><span class="o">=</span><span class="s2">&quot;gerdracor&quot;</span><span class="p">,</span>
        <span class="n">commit</span><span class="o">=</span><span class="n">chiasmus_version_commit_id</span><span class="p">,</span>
        <span class="n">corpusname</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The last corpus that is added to the local DraCor instance contains the remaining 493 documents from GerDraCor that are also used in the paper for testing purposes. In the hidden code cell below this corpus called <code class="docutils literal notranslate"><span class="pre">rest</span></code> is created:</p>
<div class="cell tag_remove-output tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># &quot;[...] remaining 493 documents from GerDraCor&quot; therefore nedd to exclude </span>
<span class="c1"># all the plays by Friedrich Schiller in the two lists above</span>

<span class="n">chiasmus_playnames_exclude</span> <span class="o">=</span> <span class="n">chiasmus_annotated_schiller_corpus_playnames</span> <span class="o">+</span> <span class="n">chiasmus_schiller_testset_playnames</span>

<span class="n">chiasmus_rest_corpus_metadata</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;rest&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Non-Schiller plays&quot;</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Corpus of the remaining plays in GerDraCor used to test the Chiasmus Classifier&quot;</span>
<span class="p">}</span>

<span class="c1"># Add the GerDraCor version, but change the Corpus Metadata; exclude all Schiller-plays added before as separate corpora</span>

<span class="n">chiasmus_detection_dracor</span><span class="o">.</span><span class="n">add_corpus_from_repo</span><span class="p">(</span>
                             <span class="n">commit</span> <span class="o">=</span> <span class="n">chiasmus_version_commit_id</span><span class="p">,</span>
                             <span class="n">repository_name</span> <span class="o">=</span> <span class="s2">&quot;gerdracor&quot;</span><span class="p">,</span>
                             <span class="n">use_metadata_of_corpus_xml</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                             <span class="n">corpus_metadata</span> <span class="o">=</span> <span class="n">chiasmus_rest_corpus_metadata</span><span class="p">,</span> 
                             <span class="n">exclude</span> <span class="o">=</span> <span class="n">chiasmus_playnames_exclude</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="local-chiasmus-detection-dracor">
<a class="reference internal image-reference" href="_images/local_chiasmus_detection_dracor.png"><img alt="_images/local_chiasmus_detection_dracor.png" src="_images/local_chiasmus_detection_dracor.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 15 </span><span class="caption-text">Frontend of the local DraCor infrastructure including the corpora mentioned in the “Chiasmus Detection” paper</span><a class="headerlink" href="#local-chiasmus-detection-dracor" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="gerdracor-based-dlina-sydney-corpus">
<span id="section-4-4-2"></span><h3>4.4.2 GerDraCor-based DLINA Sydney Corpus<a class="headerlink" href="#gerdracor-based-dlina-sydney-corpus" title="Link to this heading">#</a></h3>
<p>In section <a class="reference internal" href="3-2_gerdracor_corpus_archeology.html#excursus-gerdracor-birth"><span class="std std-ref">3.1 The “Birth” of GerDraCor</span></a> the DLINA Sidney Corpus was mentioned as the main source of the later GerDraCor corpus. The original DLINA corpus contained 465 plays taken from the TextGrid Repository. As the corpus archeology (see <a class="reference internal" href="3-2_gerdracor_corpus_archeology.html#excursus-major-revisions"><span class="std std-ref">Batch Edits as Major Revisions</span></a>) has shown there were several significant changes to the encoding which would result in the early added data not being compatible with the current versions of the DraCor API. Still, it might be an interesting use case to repeat earlier studies of the DLINA collective on the basis of a recent version of the data. Therefore, the following code samples demonstrate how a GerDraCor-based DLINA corpus can be built in a local DraCor setup. It will include all 465 plays originally included in the DLINA corpus, but in the versions as are included in the latest GerDraCor.</p>
<div class="cell tag_hide-cell tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dlina_gerdracor</span> <span class="o">=</span> <span class="n">StableDraCor</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;dlina_gerdracor&quot;</span><span class="p">,</span> 
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;DraCor system including all plays available in the DLINA Sydney corpus in a recent DraCor encoding&quot;</span><span class="p">,</span>
    <span class="n">github_access_token</span><span class="o">=</span><span class="n">github_token</span>
<span class="p">)</span>

<span class="n">dlina_gerdracor</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>With the commit “fdac66ba90c2c094012dc90395e952411d324e4c” the original DLINA file names of all TEI-XML files are changed to now match the identifier playname in GerDraCor, but after that, there are still some files renamed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Should get the list of the original playnames, </span>
<span class="c1"># but make sure there are no problems with renamed plays</span>

<span class="n">version_renaming_id</span> <span class="o">=</span> <span class="s2">&quot;fdac66ba90c2c094012dc90395e952411d324e4c&quot;</span>

<span class="c1"># From the dictonary representing the &quot;version&quot; get the field &quot;playnames&quot; that contains the</span>
<span class="c1"># plays available in a certain version</span>

<span class="n">dlina_playnames</span> <span class="o">=</span> <span class="n">repo</span><span class="o">.</span><span class="n">get_corpus_version</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="n">version_renaming_id</span><span class="p">)[</span><span class="s2">&quot;playnames&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the file-names from the renaming version</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rename_incidents</span> <span class="o">=</span> <span class="n">repo</span><span class="o">.</span><span class="n">get_renamed_files</span><span class="p">(</span>
    <span class="n">exclude_versions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;e18c322706417825229f1471b15bd6daaeaf3ab1&quot;</span><span class="p">,</span> 
                     <span class="s2">&quot;fdac66ba90c2c094012dc90395e952411d324e4c&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_gerdracor_playnames</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">unchanged_playnames</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">original_playname</span> <span class="ow">in</span> <span class="n">dlina_playnames</span><span class="p">:</span>
    <span class="n">renamed_flag</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">rename_incidents</span><span class="p">:</span>
        <span class="k">if</span> <span class="sa">f</span><span class="s2">&quot;tei/</span><span class="si">{</span><span class="n">original_playname</span><span class="si">}</span><span class="s2">.xml&quot;</span> <span class="o">==</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;previous_filename&quot;</span><span class="p">]:</span>
            <span class="n">new_gerdracor_playname</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;new_filename&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.xml&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">new_gerdracor_playnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_gerdracor_playname</span><span class="p">)</span>
            <span class="n">renamed_flag</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">renamed_flag</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">unchanged_playnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">original_playname</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the latest commit to the GerDraCor repository. </span>
<span class="c1"># This will be included in the description of the new corpus</span>
<span class="c1"># it is also needed because this version will be used as source of the plays added to the corpus</span>

<span class="n">latest_gerdracor_version_id</span> <span class="o">=</span> <span class="n">repo</span><span class="o">.</span><span class="n">get_latest_corpus_version</span><span class="p">()[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>

<span class="c1"># Add an empty new corpus &quot;dlina&quot; with the following metadata</span>

<span class="n">dlina_corpus_metadata</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;dlina&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;GerDraCor-based DLINA Corpus Sydney&quot;</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Version of the German Drama Corpus (GerDraCor, version </span><span class="si">{</span><span class="n">latest_gerdracor_version_id</span><span class="si">}</span><span class="s2">) containing only plays available in the DLINA Corpus Sydney&quot;</span>
<span class="p">}</span>

<span class="n">dlina_gerdracor</span><span class="o">.</span><span class="n">add_corpus</span><span class="p">(</span><span class="n">corpus_metadata</span><span class="o">=</span><span class="n">dlina_corpus_metadata</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add each play in the respective version to the previously created corpus</span>

<span class="n">playnames_to_add</span> <span class="o">=</span> <span class="n">new_gerdracor_playnames</span> <span class="o">+</span> <span class="n">unchanged_playnames</span>

<span class="k">for</span> <span class="n">playname</span> <span class="ow">in</span> <span class="n">playnames_to_add</span><span class="p">:</span>
    <span class="n">dlina_gerdracor</span><span class="o">.</span><span class="n">add_play_version_to_corpus</span><span class="p">(</span>
        <span class="n">filename</span><span class="o">=</span><span class="n">playname</span><span class="p">,</span>
        <span class="n">repository_name</span><span class="o">=</span><span class="s2">&quot;gerdracor&quot;</span><span class="p">,</span>
        <span class="n">commit</span><span class="o">=</span><span class="n">latest_gerdracor_version_id</span><span class="p">,</span>
        <span class="n">corpusname</span><span class="o">=</span><span class="s2">&quot;dlina&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:root:Could not add play from source &#39;https://raw.githubusercontent.com/dracor-org/gerdracor/2def59bb9123187740bf4c3136eb500deee154db/tei/fouque-der-held-des-nordens.xml&#39;.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is not a renaming problem with fouque-der-held-des-nordens; </span>
<span class="c1"># the play has been split up in three</span>

<span class="c1"># Mir fällt schon auf, Ich frag hier immer wegen DLINA... also https://dlina.github.io/linas/212/ gibt es so nicht mehr; das ist kein Fall von &quot;Umbenennung&quot;; ist das aus dem ursprünglichen lina212 -&gt; </span>
<span class="c1"># TEI version	ger000212, ger000471 und ger000470 geworden?</span>

<span class="c1">#pt jip, das ist in DraCor gesplittet</span>

<span class="c1"># ff: a, die 5 mehrteiligen stücke in dieser liste (von 2015) hatten wir schon vorher gesplittet:https://github.com/DLiNa/project/blob/master/data/TextGrid-Repository---List-of-all-dramatic-texts.txt</span>

<span class="c1"># (in der liste die nummern 18, 137, 217, 273, 490 – das waren aber noch keine dracor-IDs)</span>

<span class="c1">#bei fouqués held des nordens fiel mir die mehrteiligkeit dann erst auf, als ich stück für stück durchgegangen bin, daher das spätere splitting…</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sigurd, der Schlangentödter</span>
<span class="c1"># &quot;fouque-sigurds-rache&quot;</span>
<span class="c1"># Aslauga</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The DLINA play https://dlina.github.io/linas/212/ is actually a trilogy; </span>
<span class="c1">#In GerDraCor the play is split into three indiviual plays</span>

<span class="n">fouque_held_des_nordens_part_playnames</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;fouque-sigurd-der-schlangentoedter&quot;</span><span class="p">,</span>
    <span class="s2">&quot;fouque-sigurds-rache&quot;</span><span class="p">,</span>
    <span class="s2">&quot;fouque-aslauga&quot;</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">playname</span> <span class="ow">in</span> <span class="n">fouque_held_des_nordens_part_playnames</span><span class="p">:</span>
    <span class="n">dlina_gerdracor</span><span class="o">.</span><span class="n">add_play_version_to_corpus</span><span class="p">(</span>
        <span class="n">filename</span><span class="o">=</span><span class="n">playname</span><span class="p">,</span>
        <span class="n">repository_name</span><span class="o">=</span><span class="s2">&quot;gerdracor&quot;</span><span class="p">,</span>
        <span class="n">commit</span><span class="o">=</span><span class="n">latest_gerdracor_version_id</span><span class="p">,</span>
        <span class="n">corpusname</span><span class="o">=</span><span class="s2">&quot;dlina&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="local-dlina-dracor">
<a class="reference internal image-reference" href="_images/local_dlina_dracor.png"><img alt="_images/local_dlina_dracor.png" src="_images/local_dlina_dracor.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 16 </span><span class="caption-text">Frontend of the local DraCor infrastructure including the plays contained in the DLINA Corpus Sydney</span><a class="headerlink" href="#local-dlina-dracor" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get links to the commits that add the three individual plays</span>

<span class="k">for</span> <span class="n">playname</span> <span class="ow">in</span> <span class="n">fouque_held_des_nordens_part_playnames</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">repo</span><span class="o">.</span><span class="n">get_github_commit_url_of_version</span><span class="p">(</span>
        <span class="n">repo</span><span class="o">.</span><span class="n">get_corpus_version_adding_play</span><span class="p">(</span><span class="n">playname</span><span class="o">=</span><span class="n">playname</span><span class="p">)[</span><span class="s2">&quot;id&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<p>On December 16th, 2018 the play with the filename <code class="docutils literal notranslate"><span class="pre">fouque-der-held-des-nordens.xml</span></code> which is actually a trilogy was split up into three individual plays.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>

# Stop and remove all Docker containers to avoid conflicts 
# especially regarding ports in the next section
# This cell does not show up in the final rendering of the report
# If you want to use the Docker containers above and play around with them, 
# the following commands should NOT be run

docker stop $(docker ps -a -q)
docker rm $(docker ps -a -q)
</pre></div>
</div>
</div>
</div>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="dockerfile" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">1</a><span class="fn-bracket">]</span></span>
<p>In the <a class="reference external" href="https://docs.docker.com/glossary">glossary</a> available as part of the <a class="reference external" href="https://docs.docker.com">Docker documentation</a> the Dockerfile is explained as such: “A Dockerfile is a text document that contains all the commands you would normally execute manually in order to build a Docker image. Docker can build images automatically by reading the instructions from a Dockerfile.” <a class="reference external" href="https://docs.docker.com/glossary/#dockerfile">https://docs.docker.com/glossary/#dockerfile</a>; also see the <a class="reference external" href="https://docs.docker.com/reference/dockerfile">documentation of the Dockerfile</a>.</p>
</aside>
<aside class="footnote brackets" id="dockerimage" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">2</a><span class="fn-bracket">]</span></span>
<p>“Docker images are the basis of containers. An image is an ordered collection of root filesystem changes and the corresponding execution parameters for use within a container runtime. An image typically contains a union of layered filesystems stacked on top of each other. An image does not have state and it never changes.” <a class="reference external" href="https://docs.docker.com/glossary/#image">https://docs.docker.com/glossary/#image</a></p>
</aside>
<aside class="footnote brackets" id="dockercontainer" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">3</a><span class="fn-bracket">]</span></span>
<p>see <a class="reference external" href="https://docs.docker.com/glossary/#container">https://docs.docker.com/glossary/#container</a>.</p>
</aside>
<aside class="footnote brackets" id="open-container-initiative" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id7">4</a><span class="fn-bracket">]</span></span>
<p>On a side note and because someone might argue that by embracing a proprietary technology: “Linux containers” – what Docker is at its core – as a technology have been available since 2008. “Docker” was only introduced in 2013 and the company Docker Inc. actively promoted the “Open Container Initiative” (OCI, see <a class="reference external" href="https://opencontainers.org">https://opencontainers.org</a>), which was started in 2015. It developed a vendor agnostic specification of containers and images, that was released in 2017 to which the current Docker implementation adheres. This, of course, still doesn’t guarantee the longevity of the technology, but at least a total lock-in into a certain technology is circumvented.</p>
</aside>
<aside class="footnote brackets" id="graz-presentation" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id8">5</a><span class="fn-bracket">]</span></span>
<p>This experiment has also been presented at the “DH2023” conference in Graz. Cf. <span id="id25">[<a class="reference internal" href="bibliography.html#id24" title="Ingo Boerner, Peer Trilcke, Carsten Milling, Frank Fischer, and Henny Sluyter-Gäthje. Dockerizing DraCor – A Container-based Approach to Reproducibility in Computational Literary Studies. In Anne Baillot, Toma Tasovac, Walter Scholger, and Georg Vogeler, editors, Digital Humanities 2023: Book of Abstracts. Graz, June 2023. URL: https://zenodo.org/record/8107836 (visited on 2024-03-14), doi:10.5281/ZENODO.8107836.">Boerner <em>et al.</em>, 2023</a>]</span>. See also the <a class="reference external" href="https://zenodo.org/records/8183676">slides of the presentation</a>. For a comprehensive evaluation of the use of container technology in research and digital publishing see <span id="id26">[<a class="reference internal" href="bibliography.html#id23" title="Matt Burton, Matthew J. Lavin, Jessica Otis, and Scott B. Weingart. Digits: Two Reports on New Units of Scholarly Publication. The Journal of Electronic Publishing, February 2020. URL: http://hdl.handle.net/2027/spo.3336451.0022.105 (visited on 2024-02-26), doi:10.3998/3336451.0022.105.">Burton <em>et al.</em>, 2020</a>]</span>.</p>
</aside>
<aside class="footnote brackets" id="dracor-docker-images" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id10">6</a><span class="fn-bracket">]</span></span>
<p>Docker images of the DraCor system components are published on the platform <a class="reference external" href="https://hub.docker.com/u/dracor">DockerHub</a>. More recent images are <code class="docutils literal notranslate"><span class="pre">dracor/api</span></code> (<a class="reference external" href="https://hub.docker.com/r/dracor/api/tags">Repository</a>), <code class="docutils literal notranslate"><span class="pre">dracor/frontend</span></code> (<a class="reference external" href="https://hub.docker.com/r/dracor/frontend/tags">Repository</a>), <code class="docutils literal notranslate"><span class="pre">dracor/metrics</span></code> (<a class="reference external" href="https://hub.docker.com/r/dracor/metrics/tags">Repository</a>) and <code class="docutils literal notranslate"><span class="pre">dracor/fuseki</span></code> (<a class="reference external" href="https://hub.docker.com/r/dracor/fuseki/tags">Repository</a>). These images are used in the production infrastructure and ideally should be used when setting up local instances as well. For reasons of allowing for replication of work that has, for example, been presented at the DH 2023 Graz conference, the image repositories with the naming convention that repeats “dracor” in the image name, e.g. <code class="docutils literal notranslate"><span class="pre">dracor/dracor-api</span></code> (<a class="reference external" href="https://hub.docker.com/r/dracor/dracor-api/tags">Repository</a>) are still kept on the platform.</p>
</aside>
<aside class="footnote brackets" id="vebidracor-image" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id11">7</a><span class="fn-bracket">]</span></span>
<p>The initial local infrastructure is defined in this <a class="reference external" href="https://github.com/dracor-org/vebidracor/blob/3c3495d6b9434913687348435a341f781413304d/docker-compose.empty.yml">Docker Compose file</a>. The Docker image of the eXist-DB containing the API as an eXist-DB application is pulled from this <a class="reference external" href="https://hub.docker.com/layers/ingoboerner/dracor-api/v0.86.3_local/images/sha256-99978fd573262968de665421a9ed2e7deee2d1199be15761013f54ead834635e?context=explore">repository on DockerHub</a>.</p>
</aside>
<aside class="footnote brackets" id="vebidracor-data-ingested" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id12">8</a><span class="fn-bracket">]</span></span>
<p>See the section “Define plays to load” in the <a class="reference external" href="https://github.com/dracor-org/vebidracor/blob/3c3495d6b9434913687348435a341f781413304d/vebidracor-workflow.ipynb">Jupyter Notebook</a> that was used to populate the database.</p>
</aside>
<aside class="footnote brackets" id="commit-vebidracor-container" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id13">9</a><span class="fn-bracket">]</span></span>
<p>The necessary steps are contained in the <a class="reference external" href="https://github.com/dracor-org/vebidracor/blob/3c3495d6b9434913687348435a341f781413304d/vebidracor-workflow.ipynb">VeBiDraCor Workflow notebook</a> in the section “Prepare container image”. See also the <a class="reference external" href="https://docs.docker.com/reference/cli/docker/container/commit">documentation</a> of the <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">commit</span></code> command.</p>
</aside>
<aside class="footnote brackets" id="smallworld-code-repo" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id14">10</a><span class="fn-bracket">]</span></span>
<p>The workflow described above is also documented in the <code class="docutils literal notranslate"><span class="pre">README.md</span></code> file in the <a class="reference external" href="https://github.com/dracor-org/small-world-paper/tree/publication-version">repository accompanying the “Small-World” study</a>. The original VeBiDraCor was built with <a class="reference external" href="https://github.com/dracor-org/vebidracor/blob/3c3495d6b9434913687348435a341f781413304d/vebidracor-workflow.ipynb">this Jupyter notebook</a>.</p>
</aside>
<aside class="footnote brackets" id="run-docker-commands-in-notebook" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id16">11</a><span class="fn-bracket">]</span></span>
<p>Running the following cell will work if this “Executeable Report” is run with the “Docker in Docker” setup as described in the <code class="docutils literal notranslate"><span class="pre">README.md</span></code> file. Using the <a class="reference external" href="https://ipython.readthedocs.io/en/stable/interactive/magics.html#cell-magics">magic cell command</a> <code class="docutils literal notranslate"><span class="pre">%%script</span> <span class="pre">bash</span> <span class="pre">--bg</span></code> will run the commands in a shell in the background directly from this Jupyter notebook. Change the first line to <code class="docutils literal notranslate"><span class="pre">%bash</span></code> if the output should be seen here but this will halt the execution of all the following cells. It will take some time until the DraCor frontend of the local infrastructure becomes available at <a class="reference external" href="http://localhost:8088">http://localhost:8088</a>. To check the status use the command <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">ps</span> <span class="pre">-a</span></code> and look for the <code class="docutils literal notranslate"><span class="pre">STATUS</span></code> of the container based on the image <code class="docutils literal notranslate"><span class="pre">ingoboerner/vebidracor-api:3.0.0</span></code>. In the “Docker in Docker” setup there is still an issue with accessing the RStudio Container at (<a class="reference external" href="http://localhost:8787">http://localhost:8787</a>)[<a class="reference external" href="http://localhost:8787">http://localhost:8787</a>] which has not been resolved yet.</p>
</aside>
<aside class="footnote brackets" id="stabledracor-dev-version" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id17">12</a><span class="fn-bracket">]</span></span>
<p>Currently, it is still recommended to use the version in development from the “dind” branch of <a class="github reference external" href="https://github.com/ingoboerner/stable-dracor/tree/dind">ingoboerner/stable-dracor</a> which implements a “Docker in Docker” setup. For a tutorial on how to use this setup see the <a class="reference external" href="https://github.com/ingoboerner/stable-dracor/blob/dind/notebooks/02_intro.ipynb">introduction notebook</a>.</p>
</aside>
<aside class="footnote brackets" id="manifest-as-single-source-of-truth" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id18">13</a><span class="fn-bracket">]</span></span>
<p>If someone would not want to or for some reasons could not use Docker, the manifest alone would still be a sufficient source to retrieve the files used if they come from a corpus on GitHub. Of course, if local files are used, this does not help, but at least, it makes this circumstance transparent.</p>
</aside>
<aside class="footnote brackets" id="manifest-explained" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id19">14</a><span class="fn-bracket">]</span></span>
<p>For an explanation of the manifest see the <a class="reference external" href="https://github.com/ingoboerner/stable-dracor/blob/df31c4e6b42d0e8c6ba294efe4d26aa473719ab2/notebooks/02_intro.ipynb">introduction notebook</a> to the tool.</p>
</aside>
<aside class="footnote brackets" id="docker-object-labels" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id20">15</a><span class="fn-bracket">]</span></span>
<p>See (<a class="reference external" href="https://docs.docker.com/config/labels-custom-metadata">https://docs.docker.com/config/labels-custom-metadata</a>)[<a class="reference external" href="https://docs.docker.com/config/labels-custom-metadata">https://docs.docker.com/config/labels-custom-metadata</a>] for the documentation of Docker Object Labels.</p>
</aside>
<aside class="footnote brackets" id="dlina-research" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id21">16</a><span class="fn-bracket">]</span></span>
<p>For research carried out using the DLINA corpus see <a class="reference external" href="https://dlina.github.io">DLINA Blog</a> and the <a class="reference external" href="https://dracor.org/doc/research">DraCor Research Page</a>). For an example of a re-implementation of an algorithm developed in DLINA to be used with the DraCor API see the Jupyter Notebook <a class="reference external" href="https://github.com/dracor-org/dracor-notebooks/blob/2452d3f23de449783f4c964708cf9e88c65e35af/catch-a-protagonist-in-dracor/catch-a-protagonist-in-dracor.ipynb">To catch a protagonist in DraCor</a>.</p>
</aside>
<aside class="footnote brackets" id="sighum5" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id23">17</a><span class="fn-bracket">]</span></span>
<p>This date is at least also plausible because it is far before the date the research paper was presented at 5th Joint SIGHUM Workshop on Computational Linguistics for Cultural Heritage, Social Sciences, Humanities and Literature which that took place in November 2021, both online and in person in Punta Cana, Dominican Republic. The paper submission deadline for this event was in August 2021 according to the <a class="reference external" href="https://sighum.wordpress.com/events/latech-clfl-2021/important-dates">conference website</a>.</p>
</aside>
</aside>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="3-2_gerdracor_corpus_archeology.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Excursus: An Algorithmic Archaeology of a Living Corpus: GerDraCor as a Dynamic Epistemic Object</p>
      </div>
    </a>
    <a class="right-next"
       href="5_key_takeaways.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">5. Key Takeaways</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#containerizing-a-research-environment">4.1 Containerizing a Research Environment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-study-dockerizing-a-complete-cls-study">4.2 Case Study: Dockerizing a Complete CLS Study</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simplifying-the-workflow-stabledracor">4.3 Simplifying the Workflow: StableDraCor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#practical-examples">4.4 Practical Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reconstructing-and-stabilizing-corpora-used-to-train-and-evaluate-a-classifier-for-chiasmus-detection">4.4.1 Reconstructing (and Stabilizing) Corpora Used to Train and Evaluate a Classifier for Chiasmus Detection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gerdracor-based-dlina-sydney-corpus">4.4.2 GerDraCor-based DLINA Sydney Corpus</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ingo Börner, Peer Trilcke
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>